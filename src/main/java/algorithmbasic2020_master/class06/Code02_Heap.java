package algorithmbasic2020_master.class06;

import java.util.Comparator;
import java.util.PriorityQueue;

public class Code02_Heap {
    /**
     * <pre>
     * å°é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹çš„å€¼ â‰¤ å…¶å­èŠ‚ç‚¹çš„å€¼
     *                       1
     *                  â†™        â†˜
     *              3                2
     *           â†™    â†˜            â†™    â†˜
     *          6      4          2      6
     *        â†™  â†˜    â†™  â†˜      â†™
     *       8   7   9    6    5
     * </pre>
     * <pre>
     * å¤§é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹çš„å€¼ >= å…¶å­èŠ‚ç‚¹çš„å€¼
     *                       9
     *                  â†™        â†˜
     *              8                6
     *           â†™    â†˜            â†™    â†˜
     *          6      7          5      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6     2
     * </pre>
     * å †ä½œä¸ºå®Œå…¨äºŒå‰æ ‘çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ã€‚
     * 1.æœ€åº•å±‚èŠ‚ç‚¹é å·¦å¡«å……ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹éƒ½è¢«å¡«æ»¡ã€‚
     * 2.æˆ‘ä»¬å°†äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ç§°ä¸ºâ€œå †é¡¶â€ï¼Œå°†åº•å±‚æœ€é å³çš„èŠ‚ç‚¹ç§°ä¸ºâ€œå †åº•â€ã€‚
     * 3.å¯¹äºå¤§é¡¶å †ï¼ˆå°é¡¶å †ï¼‰ï¼Œå †é¡¶å…ƒç´ ï¼ˆå³æ ¹èŠ‚ç‚¹ï¼‰çš„å€¼åˆ†åˆ«æ˜¯æœ€å¤§ï¼ˆæœ€å°ï¼‰çš„ã€‚
     * <p>
     * è®¸å¤šç¼–ç¨‹è¯­è¨€æä¾›çš„æ˜¯ã€Œä¼˜å…ˆé˜Ÿåˆ— priority queueã€ï¼Œè¿™æ˜¯ä¸€ç§æŠ½è±¡æ•°æ®ç»“æ„ï¼Œå®šä¹‰ä¸ºå…·æœ‰ä¼˜å…ˆçº§æ’åºçš„é˜Ÿåˆ—ã€‚
     * å®é™…ä¸Šï¼Œå †é€šå¸¸ç”¨ä½œå®ç°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¤§é¡¶å †ç›¸å½“äºå…ƒç´ æŒ‰ä»å¤§åˆ°å°é¡ºåºå‡ºé˜Ÿçš„ä¼˜å…ˆé˜Ÿåˆ—ã€‚ä»ä½¿ç”¨è§’åº¦æ¥çœ‹ï¼Œ
     * æˆ‘ä»¬å¯ä»¥å°†â€œä¼˜å…ˆé˜Ÿåˆ—â€å’Œâ€œå †â€çœ‹ä½œç­‰ä»·çš„æ•°æ®ç»“æ„ã€‚
     *
     * <pre>
     * ç”±äºå †æ­£æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨æ•°ç»„æ¥å­˜å‚¨å †
     * èŠ‚ç‚¹æŒ‡é’ˆé€šè¿‡ç´¢å¼•æ˜ å°„å…¬å¼æ¥å®ç°
     * ç»™å®šç´¢å¼• ğ‘– ï¼Œå…¶å·¦å­èŠ‚ç‚¹ç´¢å¼•ä¸º 2ğ‘– + 1 ï¼Œå³å­èŠ‚ç‚¹ç´¢å¼•ä¸º 2ğ‘– + 2 ï¼Œçˆ¶èŠ‚ç‚¹ç´¢å¼•ä¸º (ğ‘– âˆ’ 1)/2ï¼ˆå‘ä¸‹å–æ•´ï¼‰
     * å½“ç´¢å¼•è¶Šç•Œæ—¶ï¼Œè¡¨ç¤ºç©ºèŠ‚ç‚¹æˆ–èŠ‚ç‚¹ä¸å­˜åœ¨
     * å¤§é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹çš„å€¼ >= å…¶å­èŠ‚ç‚¹çš„å€¼
     *                     9[0]
     *                  â†™        â†˜
     *             8[1]           6[2]
     *           â†™    â†˜            â†™    â†˜
     *         6[3]   7[4]       5[5)   2[6]
     *        â†™  â†˜    â†™   â†˜      â†™
     *       1    4   3   6     2
     *      [7]  [8] [9] [10]   [11]
     * arr  = [ 9  8  6  6  7  5  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * </pre>
     * <p>
     * å…ƒç´ å…¥å †
     * ç»™å®šå…ƒç´  val ï¼Œæˆ‘ä»¬é¦–å…ˆå°†å…¶æ·»åŠ åˆ°å †åº•ã€‚
     * å †åŒ– heapify: ç”±äº val å¯èƒ½å¤§äºå †ä¸­å…¶ä»–å…ƒç´ ï¼Œå †çš„æˆç«‹æ¡ä»¶å¯èƒ½å·²è¢«ç ´åã€‚å› æ­¤ï¼Œéœ€è¦ä¿®å¤ä»æ’å…¥èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„å„ä¸ªèŠ‚ç‚¹
     * è€ƒè™‘ä»å…¥å †èŠ‚ç‚¹å¼€å§‹ï¼Œä»åº•è‡³é¡¶æ‰§è¡Œå †åŒ–ã€‚
     * æˆ‘ä»¬æ¯”è¾ƒæ’å…¥èŠ‚ç‚¹ä¸å…¶çˆ¶èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœæ’å…¥èŠ‚ç‚¹æ›´å¤§ï¼Œåˆ™å°†å®ƒä»¬äº¤æ¢ã€‚
     * ç„¶åç»§ç»­æ‰§è¡Œæ­¤æ“ä½œï¼Œä»åº•è‡³é¡¶ä¿®å¤å †ä¸­çš„å„ä¸ªèŠ‚ç‚¹ï¼Œ
     * ç›´è‡³è¶Šè¿‡æ ¹èŠ‚ç‚¹æˆ–é‡åˆ°æ— é¡»äº¤æ¢çš„èŠ‚ç‚¹æ—¶ç»“æŸ
     * <pre>
     * å¤§é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹çš„å€¼ >= å…¶å­èŠ‚ç‚¹çš„å€¼
     *                       9
     *                  â†™        â†˜
     *              8                6
     *           â†™    â†˜            â†™    â†˜
     *          6      7          5      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6     2
     * arr  = [ 9  8  6  6  7  5  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * æ­¤æ—¶7å…¥å †åº•
     *                       9
     *                  â†™        â†˜
     *              8                6
     *           â†™    â†˜            â†™    â†˜
     *          6      7          5      2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     7 ã€Š=
     * arr  = [ 9  8  6  6  7  5  2  1  4  3  6  2  7 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     * ä»åº•è‡³é¡¶è¿›è¡Œå †åŒ–
     * å‘ç° 5 <= 7
     *                       9
     *                  â†™        â†˜
     *              8                6
     *           â†™    â†˜            â†™    â†˜
     *          6      7          5 ã€Š=   2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     7 ã€Š=
     * arr  = [ 9  8  6  6  7  5  2  1  4  3  6  2  7 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *                         â†‘                    â†‘
     * äº¤æ¢ 5 å’Œ 7
     *                       9
     *                  â†™        â†˜
     *              8                6
     *           â†™    â†˜            â†™    â†˜
     *          6      7          7 ã€Š=   2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     5 ã€Š=
     * arr  = [ 9  8  6  6  7  7  2  1  4  3  6  2  5 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *                         â†‘                    â†‘
     * å‘ç° 6 <= 7
     *                       9
     *                  â†™        â†˜
     *              8                6 ã€Š=
     *           â†™    â†˜            â†™    â†˜
     *          6      7          7 ã€Š=   2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     5
     * arr  = [ 9  8  6  6  7  7  2  1  4  3  6  2  5 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *                â†‘        â†‘
     * äº¤æ¢ 6 å’Œ 7
     *                       9
     *                  â†™        â†˜
     *              8                7 ã€Š=
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6 ã€Š=   2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     5
     * arr  = [ 9  8  7  6  7  6  2  1  4  3  6  2  5 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *                â†‘        â†‘
     * å‘ç° 9 >= 7
     *                       9  ã€Š=
     *                  â†™        â†˜
     *              8                7 ã€Š=
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     5
     * arr  = [ 9  8  7  6  7  6  2  1  4  3  6  2  5 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *          â†‘     â†‘
     * ä¸äº¤æ¢
     * </pre>
     * å †é¡¶å…ƒç´ å‡ºå †
     * 1. äº¤æ¢å †é¡¶å…ƒç´ ä¸å †åº•å…ƒç´ ï¼ˆå³äº¤æ¢æ ¹èŠ‚ç‚¹ä¸æœ€å³å¶èŠ‚ç‚¹ï¼‰ã€‚
     * 2. äº¤æ¢å®Œæˆåï¼Œå°†å †åº•ä»åˆ—è¡¨ä¸­åˆ é™¤ï¼ˆæ³¨æ„ï¼Œç”±äºå·²ç»äº¤æ¢ï¼Œå®é™…ä¸Šåˆ é™¤çš„æ˜¯åŸæ¥çš„å †é¡¶å…ƒç´ ï¼‰ã€‚
     * 3. ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä»é¡¶è‡³åº•æ‰§è¡Œå †åŒ–
     * â€œä»é¡¶è‡³åº•å †åŒ–â€çš„æ“ä½œæ–¹å‘ä¸â€œä»åº•è‡³é¡¶å †åŒ–â€ç›¸åï¼Œæˆ‘ä»¬å°†æ ¹èŠ‚ç‚¹çš„å€¼ä¸å…¶ä¸¤ä¸ªå­èŠ‚ç‚¹çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œ
     * å°†æœ€å¤§çš„å­èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹äº¤æ¢ã€‚ç„¶åå¾ªç¯æ‰§è¡Œæ­¤æ“ä½œï¼Œç›´åˆ°è¶Šè¿‡å¶èŠ‚ç‚¹æˆ–é‡åˆ°æ— é¡»äº¤æ¢çš„èŠ‚ç‚¹æ—¶ç»“æŸ
     * <pre>
     *                       9
     *                  â†™        â†˜
     *              8                7
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     5
     * arr  = [ 9  8  7  6  7  6  2  1  4  3  6  2  5 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *          â†‘                                   â†‘
     * 1.äº¤æ¢å †é¡¶9å’Œæœ€åä¸€ä¸ªå…ƒç´ 5
     *                       5
     *                  â†™        â†˜
     *              8                7
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™    â†˜
     *       1   4   3    6    2     9
     * arr  = [ 5  8  7  6  7  6  2  1  4  3  6  2  9 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11 12
     *          â†‘                                   â†‘
     * 2.å¼¹å‡ºæœ€åä¸€ä¸ªå…ƒç´ 9
     *                       5
     *                  â†™        â†˜
     *              8                7
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6    2
     * arr  = [ 5  8  7  6  7  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * 3.ä»é¡¶è‡³åº•å¼€å§‹å †åŒ–
     * 3.1 èŠ‚ç‚¹ 5,8,7 ä¸­ 8æœ€å¤§
     *                       5  ã€Š=
     *                  â†™        â†˜
     *              8 ã€Š=            7  ã€Š=
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6    2
     * arr  = [ 5  8  7  6  7  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * 3.2 äº¤æ¢èŠ‚ç‚¹5å’Œ8
     *                       8  ã€Š=
     *                  â†™        â†˜
     *              5 ã€Š=            7
     *           â†™    â†˜            â†™    â†˜
     *          6      7          6      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6    2
     * arr  = [ 8  5  7  6  7  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     *          â†‘  â†‘
     * 3.3 èŠ‚ç‚¹ 5,6,7 ä¸­ 7æœ€å¤§
     *                       8
     *                  â†™        â†˜
     *              5 ã€Š=            7
     *           â†™    â†˜            â†™    â†˜
     *          6ã€Š=   7ã€Š=        6      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6    2
     * arr  = [ 8  5  7  6  7  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * 3.4 äº¤æ¢èŠ‚ç‚¹5å’Œ7
     *                       8
     *                  â†™        â†˜
     *              7 ã€Š=            7
     *           â†™    â†˜            â†™    â†˜
     *          6     5ã€Š=        6      2
     *        â†™  â†˜    â†™  â†˜      â†™
     *       1   4   3    6    2
     * arr  = [ 8  7  7  6  5  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     *             â†‘        â†‘
     * 3.5 èŠ‚ç‚¹ 5,4,6 ä¸­ 6æœ€å¤§
     *                       8
     *                  â†™        â†˜
     *              7               7
     *           â†™    â†˜            â†™    â†˜
     *          6     5ã€Š=        6      2
     *        â†™  â†˜    â†™  â†˜       â†™
     *       1   4   3ã€Š= 6 ã€Š=  2
     * arr  = [ 8  7  7  6  5  6  2  1  4  3  6  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     * 3.6 äº¤æ¢èŠ‚ç‚¹5å’Œ6
     *                       8
     *                  â†™        â†˜
     *              7               7
     *           â†™    â†˜            â†™    â†˜
     *          6     6ã€Š=        6      2
     *        â†™  â†˜    â†™  â†˜       â†™
     *       1   4   3   5ã€Š=   2
     * arr  = [ 8  7  7  6  6  6  2  1  4  3  5  2 ]
     * index  = 0  1  2  3  4  5  6  7  8  9  10 11
     *                      â†‘                 â†‘
     * </pre>
     */
    public static class MyMaxHeap {
        private int[] heap;
        private final int limit;
        //å³è¡¨ç¤ºå †çš„å¤§å° ä¹Ÿè¡¨ç¤º æ–°æ¥çš„èŠ‚ç‚¹ä¸€å¼€å§‹æ”¾åœ¨å“ªé‡Œ
        private int heapSize;

        public MyMaxHeap(int limit) {
            heap = new int[limit];
            this.limit = limit;
            heapSize = 0;
        }

        public boolean isEmpty() {
            return heapSize == 0;
        }

        public boolean isFull() {
            return heapSize == limit;
        }

        public void push(int value) {
            if (heapSize == limit) {
                throw new RuntimeException("heap is full");
            }
            //ä¸€å¼€å§‹æ–°æ¥çš„èŠ‚ç‚¹æ”¾åœ¨heapSizeä½ç½®
            heap[heapSize] = value;
            // value  heapSize
            heapInsert(heap, heapSize++);
        }

        /**
         * ç”¨æˆ·æ­¤æ—¶ï¼Œè®©ä½ è¿”å›æœ€å¤§å€¼ï¼Œå¹¶ä¸”åœ¨å¤§æ ¹å †ä¸­ï¼ŒæŠŠæœ€å¤§å€¼åˆ æ‰
         * å‰©ä¸‹çš„æ•°ï¼Œä¾ç„¶ä¿æŒå¤§æ ¹å †ç»„ç»‡
         * eg: [9,8,7,6,3] è¿”å›9è¿™ä¸ªå¤´èŠ‚ç‚¹
         * è®©æœ€åä¸€ä¸ªèŠ‚ç‚¹æ›¿æ¢æ‰å¤´èŠ‚ç‚¹ å¾—åˆ° [3,8,7,6,3] => [3,8,7,6]
         * ç„¶åè°ƒæ•´ æ•´ä¸ªæ ‘å˜æˆå¤§æ ¹å †çš„æ¨¡æ ·
         */
        public int pop() {
            int ans = heap[0];
            /*
             * --heapSize å…ˆå‡1 å†èµ‹å€¼
             * */
            swap(heap, 0, --heapSize);
            heapify(heap, 0, heapSize);
            return ans;
        }

        /*
         * æ–°åŠ è¿›æ¥çš„æ•°ï¼Œç°åœ¨åœåœ¨äº†indexä½ç½®ï¼Œè¯·ä¾æ¬¡å¾€ä¸Šç§»åŠ¨ï¼Œ
         * ç§»åŠ¨åˆ°0ä½ç½®ï¼Œæˆ–è€…å¹²ä¸æ‰è‡ªå·±çš„çˆ¶äº²äº†ï¼Œåœï¼
         * */
        private void heapInsert(int[] arr, int index) {
            /*
             *
             * [index]    [index-1]/2
             * index == 0
             * åˆ¤æ–­å½“å‰èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹çš„å¤§å°
             * å½“å‰èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹ çš„è¯ å½“å‰èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹çš„ä½ç½®äº¤æ¢
             * å†åˆ¤æ–­å½“å‰èŠ‚ç‚¹ä¸æ–°çš„çˆ¶èŠ‚ç‚¹çš„å¤§å° å¦‚æœå½“å‰èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹ çš„è¯ æ‰§è¡Œä¸Šé¢ç›¸åŒçš„æ“ä½œ
             * ç›´åˆ°å½“å‰èŠ‚ç‚¹è¾¾åˆ°äº†æœ€é¡¶ç«¯
             * */
            while (arr[index] > arr[(index - 1) / 2]) {
                swap(arr, index, (index - 1) / 2);
                index = (index - 1) / 2;
            }
        }

        /**
         * ä»indexä½ç½®ï¼Œå¾€ä¸‹çœ‹ï¼Œä¸æ–­çš„ä¸‹æ²‰
         * åœï¼šè¾ƒå¤§çš„å­©å­éƒ½ä¸å†æ¯”indexä½ç½®çš„æ•°å¤§ï¼›å·²ç»æ²¡å­©å­äº†
         * egï¼š[3,8,7,6] å¤´èŠ‚ç‚¹3çš„å·¦å³å­èŠ‚ç‚¹åˆ†åˆ«æ˜¯ 8 7
         * å¤´èŠ‚ç‚¹å’Œ å·¦å³å­èŠ‚ç‚¹ä¸­æœ€å¤§çš„èŠ‚ç‚¹æ¯”è¾ƒ å¦‚æœ å¤´èŠ‚ç‚¹ < å·¦å³å­èŠ‚ç‚¹ä¸­æœ€å¤§çš„èŠ‚ç‚¹ åˆ™ äº¤æ¢
         * å¾—åˆ° [8,3,7,6] 3è¿™ä¸ªèŠ‚ç‚¹ å’Œå·¦å³å­èŠ‚ç‚¹çš„æœ€å¤§å€¼æ¯”è¾ƒ äº¤æ¢
         * [8,6,7,3]  heapSizeå‘ç°3è¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰å³å­èŠ‚ç‚¹ è¶Šç•Œäº†
         */
        private void heapify(int[] arr, int index, int heapSize) {
            int left = index * 2 + 1;// å¾—åˆ°å½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸‹æ ‡
            while (left < heapSize) { // å¦‚æœæœ‰å·¦å­©å­ï¼Œæœ‰æ²¡æœ‰å³å­©å­ï¼Œå¯èƒ½æœ‰å¯èƒ½æ²¡æœ‰ï¼
                //int largest = left + 1 < heapSize && arr[left + 1] > arr[left] ? left + 1 : left;
                /**
                 *  æŠŠè¾ƒå¤§å­©å­çš„ä¸‹æ ‡ï¼Œç»™largest
                 * æœ‰å³å­èŠ‚ç‚¹ ä¸” å³å­èŠ‚ç‚¹ > å·¦å­èŠ‚ç‚¹ å½“å‰èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹äº¤æ¢
                 * æœ‰å·¦å­èŠ‚ç‚¹ ä¸” å·¦å­èŠ‚ç‚¹ > å³å­èŠ‚ç‚¹ å½“å‰èŠ‚ç‚¹å’Œå·¦å­èŠ‚ç‚¹äº¤æ¢
                 * æœ‰æ—  å·¦å³å­èŠ‚ç‚¹ æŸ¥çœ‹ heapSizeå’Œright/leftå…³ç³»
                 * */
                int largest;
                int right = left + 1;//å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ä¸‹æ ‡
                // right < heapSize  é˜²æ­¢è®¡ç®—å‡ºçš„rightä¸‹æ ‡æº¢å‡º
                if (right < heapSize && arr[right] > arr[left]) {
                    largest = right;
                } else {
                    largest = left;
                }
                /**
                 * é€‰å‡ºäº† å·¦å³å­èŠ‚ç‚¹ä¸­çš„æœ€å¤§å­èŠ‚ç‚¹çš„ä¸‹æ ‡
                 * æ¥ä¸‹æ¥ è¯¥ä¸‹æ ‡çš„å…ƒç´  å’Œ çˆ¶èŠ‚ç‚¹(å½“å‰èŠ‚ç‚¹)å…ƒç´ æ¯”è¾ƒ
                 * å“ªä¸ªå¤§ æŠŠå“ªä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡èµ‹å€¼ç»™largest
                 * */
                largest = arr[largest] > arr[index] ? largest : index;
                if (largest == index) {// è¯¥ä¸‹æ ‡çš„å…ƒç´  å’Œ çˆ¶èŠ‚ç‚¹(å½“å‰èŠ‚ç‚¹)å…ƒç´ æ¯”è¾ƒ çˆ¶èŠ‚ç‚¹å¤§ å°±ç»“æŸ
                    break;
                }
                // indexå’Œè¾ƒå¤§å­©å­ï¼Œè¦äº’æ¢
                swap(arr, largest, index);
                index = largest;
                left = index * 2 + 1;
            }
        }

        private void swap(int[] arr, int i, int j) {
            int tmp = arr[i];
            arr[i] = arr[j];
            arr[j] = tmp;
        }

    }

    public static class RightMaxHeap {
        private int[] arr;
        private final int limit;
        private int size;

        public RightMaxHeap(int limit) {
            arr = new int[limit];
            this.limit = limit;
            size = 0;
        }

        public boolean isEmpty() {
            return size == 0;
        }

        public boolean isFull() {
            return size == limit;
        }

        public void push(int value) {
            if (size == limit) {
                throw new RuntimeException("heap is full");
            }
            arr[size++] = value;
        }

        public int pop() {
            int maxIndex = 0;
            for (int i = 1; i < size; i++) {
                if (arr[i] > arr[maxIndex]) {
                    maxIndex = i;
                }
            }
            int ans = arr[maxIndex];
            arr[maxIndex] = arr[--size];
            return ans;
        }

    }


    public static class MyComparator implements Comparator<Integer> {

        @Override
        public int compare(Integer o1, Integer o2) {
            return o2 - o1;
        }

    }

    public static void main(String[] args) {
        //  é»˜è®¤å°æ ¹å †
        PriorityQueue<Integer> heap = new PriorityQueue<>(new MyComparator());
        heap.add(5);
        heap.add(5);
        heap.add(5);
        heap.add(3);
        //  5 , 3
        System.out.println(heap.peek());
        heap.add(7);
        heap.add(0);
        heap.add(7);
        heap.add(0);
        heap.add(7);
        heap.add(0);
        System.out.println(heap.peek());
        while (!heap.isEmpty()) {
            System.out.println(heap.poll());
        }


        int value = 1000;
        int limit = 100;
        int testTimes = 1000000;
        for (int i = 0; i < testTimes; i++) {
            int curLimit = (int) (Math.random() * limit) + 1;
            MyMaxHeap my = new MyMaxHeap(curLimit);
            RightMaxHeap test = new RightMaxHeap(curLimit);
            int curOpTimes = (int) (Math.random() * limit);
            for (int j = 0; j < curOpTimes; j++) {
                if (my.isEmpty() != test.isEmpty()) {
                    System.out.println("Oops!");
                }
                if (my.isFull() != test.isFull()) {
                    System.out.println("Oops!");
                }
                if (my.isEmpty()) {
                    int curValue = (int) (Math.random() * value);
                    my.push(curValue);
                    test.push(curValue);
                } else if (my.isFull()) {
                    if (my.pop() != test.pop()) {
                        System.out.println("Oops!");
                    }
                } else {
                    if (Math.random() < 0.5) {
                        int curValue = (int) (Math.random() * value);
                        my.push(curValue);
                        test.push(curValue);
                    } else {
                        if (my.pop() != test.pop()) {
                            System.out.println("Oops!");
                        }
                    }
                }
            }
        }
        System.out.println("finish!");

    }

}
